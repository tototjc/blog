---
import { ClientRouter } from 'astro:transitions'
import { title as siteTitle, description as siteDesc, author, nav, beian } from 'virtual:config'

import LoadingProgress from '@/components/LoadingProgress.astro'

import Head from '@/components/base/Head.astro'
import Header from '@/components/base/Header.astro'
import Main from '@/components/base/Main.astro'
import Footer from '@/components/base/Footer.astro'

import '@/styles/global.css'

interface Props {
  title?: string
  description?: string
}

const {
  props: { title, description = siteDesc },
  url,
  currentLocale,
} = Astro
---

<!doctype html>
<html lang={currentLocale}>
  <Head title={title} sitename={siteTitle} {description} {author}>
    <meta property="og:type" content="website" />
    <meta property="og:url" content={url} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={new URL(url.pathname + '/og.png', url)} />

    <slot name="head" />

    <ClientRouter />
  </Head>
  <body>
    <LoadingProgress />
    <Header class="container" logo={siteTitle} {nav} />
    <Main class="container">
      <slot />
    </Main>
    <Footer class="container" {author} {beian} />
  </body>
</html>

<style>
  html {
    accent-color: var(--c-primary);
    direction: ltr;
    font: normal 1rem/1.5 var(--font-default);
    font-optical-sizing: auto;
    interpolate-size: allow-keywords;
    text-rendering: optimizelegibility;
    text-size-adjust: 100%;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    scroll-behavior: smooth;
    overflow-anchor: auto;
    overflow: hidden auto;

    body {
      width: 100vw;
      padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
      background: var(--c-bg);
    }
  }

  .container {
    margin: 0 auto;
    max-width: 50rem;
    padding: 1rem;
  }
</style>
